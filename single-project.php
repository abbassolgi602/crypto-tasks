<?php

$user = wp_get_current_user();
$user_id = 'user_' . $user->ID;
$project_id = get_the_ID();

$follow_class = 'active';
$follow_text = 'follow';
$follow_name = 'follow_project';

$follow_state = false;

if(array_key_exists('follow_project', $_POST)) {
	$value = array('followed_project_id' => $project_id);
	add_row('followed_by_user_projects', $value, $user_id);
}

if(array_key_exists('un_follow_project', $_POST)) {
	$i = 1;
	while( have_rows('followed_by_user_projects',$user_id) ) { the_row();
		if(get_sub_field('followed_project_id') == $project_id) {
			delete_row('followed_by_user_projects', $i, $user_id);
			break;
		}
		$i++;
	}
}

if( have_rows('followed_by_user_projects',$user_id) ){
	while( have_rows('followed_by_user_projects',$user_id) ) { the_row();
		if(get_sub_field('followed_project_id') == $project_id) {
			$follow_state = true;
		}
	}
}

if($follow_state == true) {
	$follow_class = 'deactive';
	$follow_text = 'Followed';
	$follow_name = 'un_follow_project';
}

// FIXME: dobble follow by refresh

// unset($_POST['follow_project']);
// unset($_POST['un_follow_project']);

acf_form_head();
get_header();
?>

<div class="wrapper">
	<div class="column flex-between flex">
		<div class="w100 flex-start flex backpage">
			<span class="flex">
				<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12H18M6 12L11 7M6 12L11 17" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
				Back projects
			</span>
		</div>
		<div class="w100 d-inline-block project-detail">
			<div class="w100 flex-between flex">
				<?php
					if ( has_post_thumbnail() ) {
						the_post_thumbnail('medium');
					}
				?>
				<h1 class="h1"><?php the_title();?></h1>
				<form action="" method="post">
					<input type="submit" name="<?php echo $follow_name; ?>" class="<?php echo $follow_class; ?>-btn btn" value="<?php echo $follow_text; ?>" />
				</form>
				<!-- add_row($selector, $value, [$post_id]) -->
				<div class="socials-project">
				<?php
					$twitter = get_field('twitter_social_project');
					$instagram = get_field('instagram_social_project');
					$linkedin = get_field('linkedin_social_project');
					$github = get_field('github_social_project');
					$telegram = get_field('telegram_social_project');
					$facebook = get_field('facebook_social_project');
					$pinterest = get_field('pinterest_social_project');
					$discord = get_field('discord_social_project_copy');
					
					if ( $twitter != '' ) {
						echo '<a href="'.$twitter.'">
						<svg fill="#000000" width="800px" height="800px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M21.387 4.959c1.652 0 3.144 0.676 4.195 1.762 1.308-0.253 2.54-0.714 3.648-1.352-0.428 1.301-1.34 2.393-2.525 3.083 1.16-0.136 2.27-0.434 3.301-0.88-0.773 1.117-1.745 2.1-2.868 2.886 0.011 0.239 0.017 0.479 0.017 0.719 0 7.366-5.782 15.863-16.354 15.863-3.245 0-6.268-0.926-8.809-2.507 0.449 0.052 0.906 0.079 1.37 0.079 2.692 0 5.172-0.89 7.139-2.387-2.517-0.043-4.641-1.657-5.369-3.87 0.351 0.066 0.711 0.101 1.082 0.101 0.522 0 1.032-0.067 1.512-0.195-2.629-0.511-4.611-2.764-4.611-5.467v-0.072c0.776 0.418 1.661 0.669 2.605 0.698-1.543-1.001-2.558-2.705-2.558-4.64 0-1.022 0.284-1.981 0.779-2.801 2.834 3.371 7.069 5.591 11.847 5.824-0.098-0.407-0.149-0.837-0.149-1.27 0-3.079 2.574-5.575 5.749-5.575zM30.006 7.572v0zM21.387 2.959c-3.927 0-7.18 2.869-7.681 6.576-3.213-0.646-6.135-2.346-8.235-4.842-0.381-0.454-0.942-0.713-1.531-0.713-0.052 0-0.104 0.002-0.157 0.006-0.643 0.052-1.223 0.41-1.556 0.962-0.698 1.157-1.066 2.482-1.066 3.833 0 0.902 0.162 1.779 0.469 2.601-0.327 0.364-0.515 0.839-0.515 1.341v0.072c0 1.959 0.774 3.777 2.061 5.139-0.074 0.343-0.058 0.702 0.055 1.046 0.444 1.349 1.251 2.512 2.298 3.398-0.703 0.157-1.428 0.235-2.169 0.235-0.392 0-0.773-0.021-1.133-0.066-0.080-0.010-0.159-0.014-0.238-0.014-0.84 0-1.603 0.529-1.885 1.337-0.31 0.885 0.034 1.866 0.83 2.361 2.954 1.838 6.366 2.808 9.866 2.808 11.376 0 18.219-8.905 18.352-17.605 0.931-0.771 1.754-1.662 2.451-2.661 0.254-0.334 0.405-0.751 0.405-1.203 0-0.681-0.34-1.282-0.859-1.644 0.224-0.769-0.032-1.603-0.657-2.111-0.365-0.297-0.813-0.448-1.262-0.448-0.344 0-0.689 0.088-0.999 0.268-0.661 0.381-1.368 0.683-2.113 0.9-1.347-1.014-3.017-1.578-4.732-1.578z"></path></svg>
						</a>';
					}
					
					if ( $instagram != '' ) {
						echo '<a href="'.$instagram.'">
						<svg fill="#000000" height="800px" width="800px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" xml:space="preserve"><g id="social-instagram"><path d="M23.9,7.1c-0.1-1.3-0.3-2.1-0.6-2.9C23.1,3.4,22.7,2.7,22,2s-1.3-1.1-2.1-1.4c-0.8-0.3-1.6-0.5-2.9-0.6C15.7,0,15.3,0,12,0 S8.3,0,7.1,0.1C5.8,0.1,4.9,0.3,4.1,0.6C3.4,0.9,2.7,1.3,2,2S0.9,3.4,0.6,4.1C0.3,4.9,0.1,5.8,0.1,7.1C0,8.3,0,8.7,0,12	s0,3.7,0.1,4.9c0.1,1.3,0.3,2.1,0.6,2.9C0.9,20.6,1.3,21.3,2,22s1.3,1.1,2.1,1.4c0.8,0.3,1.6,0.5,2.9,0.6C8.3,24,8.7,24,12,24 s3.7,0,4.9-0.1c1.3-0.1,2.1-0.3,2.9-0.6c0.8-0.3,1.5-0.7,2.1-1.4s1.1-1.3,1.4-2.1c0.3-0.8,0.5-1.6,0.6-2.9C24,15.7,24,15.3,24,12 S24,8.3,23.9,7.1z M21.8,16.8c-0.1,1.2-0.2,1.8-0.4,2.2c-0.2,0.6-0.5,1-0.9,1.4s-0.8,0.7-1.4,0.9c-0.4,0.2-1.1,0.4-2.2,0.4 c-1.3,0.1-1.6,0.1-4.8,0.1s-3.6,0-4.8-0.1c-1.2-0.1-1.8-0.2-2.2-0.4c-0.6-0.2-1-0.5-1.4-0.9s-0.7-0.8-0.9-1.4 c-0.2-0.4-0.4-1.1-0.4-2.2c-0.1-1.3-0.1-1.6-0.1-4.8s0-3.6,0.1-4.8C2.3,6,2.5,5.3,2.6,4.9c0.2-0.6,0.5-1,0.9-1.4s0.8-0.7,1.4-0.9 C5.3,2.5,6,2.3,7.2,2.2C8.4,2.2,8.8,2.2,12,2.2s3.6,0,4.8,0.1c1.2,0.1,1.8,0.2,2.2,0.4c0.6,0.2,1,0.5,1.4,0.9s0.7,0.8,0.9,1.4 c0.2,0.4,0.4,1.1,0.4,2.2c0.1,1.3,0.1,1.6,0.1,4.8S21.8,15.6,21.8,16.8z"/><path d="M12,6c-3.3,0-6,2.7-6,6s2.7,6,6,6s6-2.7,6-6S15.3,6,12,6z M12,15.9c-2.2,0-3.9-1.7-3.9-3.9S9.8,8.1,12,8.1s3.9,1.7,3.9,3.9 S14.2,15.9,12,15.9z"/><circle cx="18.5" cy="6" r="1.5"/></g></svg>
						</a>';
					}
					
					if ( $linkedin != '' ) {
						echo '<a href="'.$linkedin.'">
							<svg fill="#000000" width="800px" height="800px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M31.181 31.326h-6.501c-0.46 0-0.831-0.372-0.831-0.831v-10.469c0-3.591-1.852-3.591-2.463-3.591-1.644 0-2.343 1.298-2.57 1.858-0.107 0.252-0.157 0.68-0.157 1.279v10.929c0 0.46-0.372 0.831-0.831 0.831h-6.507c-0.22 0-0.435-0.088-0.592-0.246s-0.246-0.372-0.239-0.592c0-0.176 0.088-17.732 0-19.528-0.013-0.227 0.069-0.447 0.227-0.611s0.372-0.258 0.605-0.258h6.507c0.46 0 0.831 0.372 0.831 0.831v0.491c1.096-0.976 2.677-1.783 5.033-1.783 5.209 0 8.321 3.603 8.321 9.638v11.219c0 0.46-0.372 0.831-0.831 0.831h0zM25.512 29.663l4.844-0v-10.387c0-5.071-2.425-7.975-6.658-7.975-2.828 0-4.202 1.411-5.065 2.702-0.101 0.34-0.422 0.592-0.8 0.592h-0.044c-0.302 0-0.58-0.164-0.724-0.428-0.113-0.208-0.139-0.447-0.063-0.668v-1.745h-4.832c0.044 3.471 0 14.702-0.013 17.902h4.838v-10.091c0-0.838 0.088-1.442 0.277-1.902 0.731-1.808 2.268-2.898 4.107-2.898 2.62 0 4.126 1.915 4.126 5.254v9.644h0.006zM7.723 31.326h-6.507c-0.46 0-0.831-0.372-0.831-0.831v-19.565c0-0.46 0.372-0.831 0.831-0.831h6.507c0.46 0 0.831 0.372 0.831 0.831v19.565c0 0.46-0.372 0.831-0.831 0.831zM2.047 29.663h4.844v-17.902h-4.844v17.902zM4.472 9.090l-0.044-0c-2.564 0-4.428-1.776-4.428-4.22 0-2.438 1.896-4.214 4.517-4.214 2.576 0 4.416 1.726 4.466 4.195 0 2.463-1.896 4.239-4.51 4.239zM4.516 2.324c-1.707 0-2.854 1.027-2.854 2.551 0 1.499 1.134 2.551 2.765 2.551h0.044c1.701 0 2.847-1.027 2.847-2.551-0.032-1.543-1.134-2.551-2.803-2.551z"></path></svg>
						</a>';
					}
					
					if ( $github != '' ) {
						echo '<a href="'.$github.'">
						<svg fill="#000000" width="800px" height="800px" viewBox="0 0 32 32" id="icon" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill-rule:evenodd;}.cls-2{fill:none;}</style></defs><title>logo--github</title><path class="cls-1" d="M16,2a14,14,0,0,0-4.43,27.28c.7.13,1-.3,1-.67s0-1.21,0-2.38c-3.89.84-4.71-1.88-4.71-1.88A3.71,3.71,0,0,0,6.24,22.3c-1.27-.86.1-.85.1-.85A2.94,2.94,0,0,1,8.48,22.9a3,3,0,0,0,4.08,1.16,2.93,2.93,0,0,1,.88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4,5.4,0,0,1,1.44-3.76,5,5,0,0,1,.14-3.7s1.17-.38,3.85,1.43a13.3,13.3,0,0,1,7,0c2.67-1.81,3.84-1.43,3.84-1.43a5,5,0,0,1,.14,3.7,5.4,5.4,0,0,1,1.44,3.76c0,5.38-3.27,6.56-6.39,6.91a3.33,3.33,0,0,1,.95,2.59c0,1.87,0,3.38,0,3.84s.25.81,1,.67A14,14,0,0,0,16,2Z"/><rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-2" width="32" height="32"/></svg>
						</a>';
					}
					
					if ( $telegram != '' ) {
						echo '<a href="'.$telegram.'">
						<svg fill="#000000" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" xml:space="preserve"><style type="text/css">.st0{fill:none;}</style><path d="M19.2,4.4L2.9,10.7c-1.1,0.4-1.1,1.1-0.2,1.3l4.1,1.3l1.6,4.8c0.2,0.5,0.1,0.7,0.6,0.7c0.4,0,0.6-0.2,0.8-0.4 c0.1-0.1,1-1,2-2l4.2,3.1c0.8,0.4,1.3,0.2,1.5-0.7l2.8-13.1C20.6,4.6,19.9,4,19.2,4.4z M17.1,7.4l-7.8,7.1L9,17.8L7.4,13l9.2-5.8 C17,6.9,17.4,7.1,17.1,7.4z"/><rect y="0" class="st0" width="24" height="24"/></svg>
						</a>';
					}
					
					if ( $facebook != '' ) {
						echo '<a href="'.$facebook.'">
						<svg fill="#000000"  version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  width="800px" height="800px" viewBox="0 0 512 512" xml:space="preserve"><path style="display: inline;" d="M283.122,122.174c0,5.24,0,22.319,0,46.583h83.424l-9.045,74.367h-74.379 c0,114.688,0,268.375,0,268.375h-98.726c0,0,0-151.653,0-268.375h-51.443v-74.367h51.443c0-29.492,0-50.463,0-56.302 c0-27.82-2.096-41.02,9.725-62.578C205.948,28.32,239.308-0.174,297.007,0.512c57.713,0.711,82.04,6.263,82.04,6.263 l-12.501,79.257c0,0-36.853-9.731-54.942-6.263C293.539,83.238,283.122,94.366,283.122,122.174z"></path></svg>
						</a>';
					}
					
					if ( $discord != '' ) {
						echo '<a href="'.$discord.'">
						<svg width="800px" height="800px" viewBox="0 0 192 192" xmlns="http://www.w3.org/2000/svg" fill="none"><path stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="12" d="m68 138-8 16c-10.19-4.246-20.742-8.492-31.96-15.8-3.912-2.549-6.284-6.88-6.378-11.548-.488-23.964 5.134-48.056 19.369-73.528 1.863-3.334 4.967-5.778 8.567-7.056C58.186 43.02 64.016 40.664 74 39l6 11s6-2 16-2 16 2 16 2l6-11c9.984 1.664 15.814 4.02 24.402 7.068 3.6 1.278 6.704 3.722 8.567 7.056 14.235 25.472 19.857 49.564 19.37 73.528-.095 4.668-2.467 8.999-6.379 11.548-11.218 7.308-21.769 11.554-31.96 15.8l-8-16m-68-8s20 10 40 10 40-10 40-10"/><ellipse cx="71" cy="101" fill="#000000" rx="13" ry="15"/><ellipse cx="121" cy="101" fill="#000000" rx="13" ry="15"/></svg>
						</a>';
					}
					
					if ( $pinterest != '' ) {
						echo '<a href="'.$pinterest.'">
							<svg fill="#000000" width="800px" height="800px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M27.712 10.983c-0.119-5.822-4.878-10.040-11.329-10.040-0.698 0-1.408 0.050-2.119 0.151-5.168 0.717-9.135 4.438-9.877 9.254-0.528 3.433 0.578 7.557 4.231 8.487l0.528 0.132 0.308-0.446c0.107-0.151 1.044-1.534 0.893-2.678-0.075-0.572-0.421-0.924-0.629-1.132l-0.101-0.101c-0.572-0.899-0.811-2.42-0.572-3.697 0.578-3.143 3.2-5.426 6.519-5.677 0.233-0.019 0.465-0.025 0.692-0.025 3.439 0 5.765 2.050 5.928 5.218 0.151 3.062-0.767 5.853-2.402 7.286l-0.107 0.094c-0.384 0.34-0.685 0.61-1.314 0.704-0.163 0.025-0.327 0.038-0.478 0.038-1.257 0-1.943-0.83-1.968-1.647-0.031-0.918 0.333-1.924 0.723-2.993 0.478-1.314 0.974-2.678 0.792-4.086-0.195-1.459-1.521-2.596-3.024-2.596-0.383 0-0.773 0.075-1.151 0.214-2.728 1.037-3.131 4.608-2.131 7.488-0.239 1.138-0.547 2.263-0.874 3.451-0.974 3.577-1.987 7.28-1.22 11.618l0.17 0.962 0.899-0.371c0.874-0.365 1.345-1.169 1.735-1.836 0.075-0.126 0.151-0.252 0.22-0.371 1.276-2.006 1.993-4.401 2.546-6.727 1.377 1.037 2.785 1.371 4.791 1.151 5.545-0.604 8.424-6.545 8.318-11.826zM12.706 15.038l0.044-0.22-0.082-0.214c-0.855-2.257-0.66-5.004 1.144-5.69 0.195-0.075 0.396-0.113 0.591-0.113 0.736 0 1.383 0.541 1.471 1.232 0.138 1.031-0.277 2.15-0.71 3.345-0.421 1.157-0.861 2.351-0.817 3.577 0.050 1.534 1.308 3.162 3.533 3.162 0.233 0 0.471-0.019 0.717-0.057 1.088-0.163 1.691-0.698 2.125-1.088l0.101-0.088c1.98-1.741 3.106-5.017 2.93-8.544-0.214-4.262-3.615-7.029-8.299-6.677-4.042 0.308-7.23 3.099-7.94 6.953-0.308 1.66 0.013 3.602 0.792 4.828 0.094 0.145 0.201 0.258 0.302 0.358 0.069 0.075 0.182 0.182 0.189 0.233 0.025 0.214-0.107 0.654-0.333 1.088-2.276-0.968-2.917-4.030-2.527-6.551 0.629-4.124 4.061-7.318 8.544-7.94 0.641-0.088 1.282-0.132 1.905-0.132 5.558 0 9.663 3.577 9.757 8.506 0.094 4.589-2.301 9.732-6.909 10.241-0.314 0.031-0.61 0.050-0.886 0.050-1.672 0-2.571-0.578-3.653-1.653l-1.006-1-0.308 1.383c-0.591 2.628-1.276 5.375-2.634 7.513-0.088 0.138-0.176 0.289-0.264 0.446-0.031 0.057-0.063 0.113-0.101 0.163-0.251-3.357 0.578-6.4 1.389-9.361 0.333-1.226 0.685-2.502 0.937-3.753z"></path></svg>
						</a>';
					}
				?>
				</div>
			</div>
			<div class="w100 flex-between flex project-content">
				<?php the_content(); ?>
			</div>
		</div>
	</div>
</div>
	
 
<?php get_footer(); ?>